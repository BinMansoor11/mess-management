(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[833],{2066:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>R});var s=n(7876),i=n(4232),a=n(5751),r=n(5003),c=n(5754),l=n(1316),d=n(8952),o=n(3061),m=n(8785),h=n(4245),x=n(595),u=n(5389),j=n(8836),A=n(5774),g=n(6952),y=n(532),p=n(8085),b=n(7161),v=n(8796),f=n(5999),U=n(2739),k=n(9505),I=n(5307),w=n(4312);n(3890);let R=()=>{let{state:e}=(0,k.U)(),t=new Date,[n,R]=(0,i.useState)(t.getFullYear()),[N,M]=(0,i.useState)(t.getMonth()+1),C=(0,I.P2)(e.usage,e.items,e.meals,n,N);return(0,s.jsxs)(a.A,{children:[(0,s.jsxs)(a.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[(0,s.jsx)(r.A,{variant:"h4",children:"Statistics & Reports"}),(0,s.jsxs)(a.A,{children:[(0,s.jsx)(c.A,{variant:"outlined",startIcon:(0,s.jsx)(U.A,{}),onClick:()=>{let e=new w.default;e.setFontSize(20),e.text("Monthly Report - ".concat(N,"/").concat(n),14,22),e.setFontSize(12),e.text("Meals Prepared: ".concat(C.mealsPrepared),14,32),e.text("Most Used Items:",14,42);let t=C.mostUsedItems.map(e=>[e.name,"".concat(e.totalUsed," ").concat(e.unit)]);e.autoTable({head:[["Item","Total Used"]],body:t,startY:47});let s=e.lastAutoTable.finalY+10;e.text("Items Needing Restocking:",14,s);let i=C.itemsNeedRestocking.map(e=>[e.name,"".concat(e.remaining," ").concat(e.unit," remaining")]);e.autoTable({startY:s+5,head:[["Item","Remaining"]],body:i}),e.save("stats-".concat(n,"-").concat(N,".pdf"))},sx:{mr:2},children:"Export PDF"}),(0,s.jsx)(c.A,{variant:"contained",startIcon:(0,s.jsx)(U.A,{}),onClick:()=>{let e=[{Metric:"Meals Prepared",Value:C.mealsPrepared},...C.mostUsedItems.map((e,t)=>({Metric:"Top Used Item #".concat(t+1),Value:"".concat(e.name," (").concat(e.totalUsed," ").concat(e.unit,")")})),...C.itemsNeedRestocking.map((e,t)=>({Metric:"Needs Restocking #".concat(t+1),Value:"".concat(e.name," (only ").concat(e.remaining," ").concat(e.unit," left)")}))];(0,I.GF)(e,"stats-".concat(n,"-").concat(N))},children:"Export CSV"})]})]}),(0,s.jsx)(a.A,{sx:{mb:3,p:2,bgcolor:"background.paper",borderRadius:1},children:(0,s.jsxs)(l.Ay,{container:!0,spacing:2,children:[(0,s.jsx)(l.Ay,{item:!0,xs:12,sm:6,children:(0,s.jsxs)(d.A,{fullWidth:!0,children:[(0,s.jsx)(o.A,{children:"Year"}),(0,s.jsx)(m.A,{value:n,label:"Year",onChange:e=>R(Number(e.target.value)),children:[2022,2023,2024,2025].map(e=>(0,s.jsx)(h.A,{value:e,children:e},e))})]})}),(0,s.jsx)(l.Ay,{item:!0,xs:12,sm:6,children:(0,s.jsxs)(d.A,{fullWidth:!0,children:[(0,s.jsx)(o.A,{children:"Month"}),(0,s.jsx)(m.A,{value:N,label:"Month",onChange:e=>M(Number(e.target.value)),children:["January","February","March","April","May","June","July","August","September","October","November","December"].map((e,t)=>(0,s.jsx)(h.A,{value:t+1,children:e},e))})]})})]})}),(0,s.jsxs)(l.Ay,{container:!0,spacing:3,sx:{mb:4},children:[(0,s.jsx)(l.Ay,{item:!0,xs:12,sm:6,md:3,children:(0,s.jsx)(x.A,{children:(0,s.jsxs)(u.A,{children:[(0,s.jsx)(r.A,{variant:"h4",gutterBottom:!0,children:C.mealsPrepared}),(0,s.jsx)(r.A,{variant:"body2",color:"text.secondary",children:"Meals Prepared"})]})})}),(0,s.jsx)(l.Ay,{item:!0,xs:12,sm:6,md:3,children:(0,s.jsx)(x.A,{children:(0,s.jsxs)(u.A,{children:[(0,s.jsx)(r.A,{variant:"h4",gutterBottom:!0,children:C.mostUsedItems.length}),(0,s.jsx)(r.A,{variant:"body2",color:"text.secondary",children:"Top Items Used"})]})})}),(0,s.jsx)(l.Ay,{item:!0,xs:12,sm:6,md:3,children:(0,s.jsx)(x.A,{children:(0,s.jsxs)(u.A,{children:[(0,s.jsx)(r.A,{variant:"h4",gutterBottom:!0,children:C.itemsNeedRestocking.length}),(0,s.jsx)(r.A,{variant:"body2",color:"text.secondary",children:"Items Need Restocking"})]})})}),(0,s.jsx)(l.Ay,{item:!0,xs:12,sm:6,md:3,children:(0,s.jsx)(x.A,{children:(0,s.jsxs)(u.A,{children:[(0,s.jsx)(r.A,{variant:"h4",gutterBottom:!0,children:Object.keys(C.itemUsage).length}),(0,s.jsx)(r.A,{variant:"body2",color:"text.secondary",children:"Different Items Used"})]})})})]}),(0,s.jsxs)(l.Ay,{container:!0,spacing:3,children:[(0,s.jsx)(l.Ay,{item:!0,xs:12,md:6,children:(0,s.jsx)(x.A,{children:(0,s.jsxs)(u.A,{children:[(0,s.jsx)(r.A,{variant:"h6",gutterBottom:!0,children:"Most Used Items"}),(0,s.jsx)(j.A,{children:(0,s.jsxs)(A.A,{size:"small",children:[(0,s.jsx)(g.A,{children:(0,s.jsxs)(y.A,{children:[(0,s.jsx)(p.A,{children:"Item"}),(0,s.jsx)(p.A,{align:"right",children:"Total Used"})]})}),(0,s.jsx)(b.A,{children:C.mostUsedItems.map((e,t)=>(0,s.jsxs)(y.A,{children:[(0,s.jsx)(p.A,{children:e.name}),(0,s.jsxs)(p.A,{align:"right",children:[e.totalUsed," ",e.unit]})]},t))})]})})]})})}),(0,s.jsx)(l.Ay,{item:!0,xs:12,md:6,children:(0,s.jsx)(x.A,{children:(0,s.jsxs)(u.A,{children:[(0,s.jsx)(r.A,{variant:"h6",gutterBottom:!0,children:"Items Needing Restocking"}),0===C.itemsNeedRestocking.length?(0,s.jsx)(v.A,{severity:"success",children:"All items have sufficient stock!"}):(0,s.jsx)(a.A,{children:C.itemsNeedRestocking.map((e,t)=>(0,s.jsxs)(a.A,{sx:{mb:2},children:[(0,s.jsxs)(a.A,{sx:{display:"flex",justifyContent:"space-between",mb:1},children:[(0,s.jsx)(r.A,{variant:"body2",children:e.name}),(0,s.jsxs)(r.A,{variant:"body2",children:[e.remaining," ",e.unit," remaining"]})]}),(0,s.jsx)(f.A,{variant:"determinate",value:e.remaining/(e.remaining+e.used)*100,color:"error",sx:{height:8,borderRadius:4}})]},t))})]})})})]})]})}},5307:(e,t,n)=>{"use strict";n.d(t,{GF:()=>r,J8:()=>i,P2:()=>a,Yq:()=>s});let s=e=>new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),i=(e,t)=>e.filter(e=>(!t.name||!!e.name.toLowerCase().includes(t.name.toLowerCase()))&&(!t.status||e.status===t.status)&&(!t.unit||e.unit===t.unit)),a=(e,t,n,s,i)=>{let a=new Date(s,i-1,1),r=new Date(s,i,0),c=e.filter(e=>{let t=new Date(e.date);return t>=a&&t<=r}),l=c.length,d={};c.forEach(e=>{e.itemsUsed.forEach(e=>{d[e.itemId]||(d[e.itemId]=0),d[e.itemId]+=e.totalUsed})});let o=t.map(e=>{let t=d[e.id]||0,n=e.quantity-t;return{...e,used:t,remaining:n,needsRestocking:n<.2*e.quantity}}).filter(e=>e.needsRestocking),m=Object.entries(d).map(e=>{let[n,s]=e,i=t.find(e=>e.id===n);return{name:(null==i?void 0:i.name)||"Unknown",totalUsed:s,unit:(null==i?void 0:i.unit)||""}}).sort((e,t)=>t.totalUsed-e.totalUsed).slice(0,5);return{mealsPrepared:l,itemUsage:d,itemsNeedRestocking:o,mostUsedItems:m}},r=(e,t)=>{let n=Object.keys(e[0]||{}).join(","),s=e.map(e=>Object.values(e).map(e=>"string"==typeof e&&e.includes(",")?'"'.concat(e,'"'):e).join(",")).join("\n"),i=new Blob(["".concat(n,"\n").concat(s)],{type:"text/csv;charset=utf-8;"}),a=document.createElement("a"),r=URL.createObjectURL(i);a.setAttribute("href",r),a.setAttribute("download","".concat(t,".csv")),a.style.visibility="hidden",document.body.appendChild(a),a.click(),document.body.removeChild(a)}},9844:(e,t,n)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/stats",function(){return n(2066)}])}},e=>{e.O(0,[347,316,133,796,453,948,636,593,792],()=>e(e.s=9844)),_N_E=e.O()}]);